Ciberseguridad en ecommerce

| üß± Funcionalidad              | ‚ö†Ô∏è Vulnerabilidad                                                                                   | üí£ Ejemplo de ataque pr√°ctico                                                                  | üõ°Ô∏è Mitigaci√≥n / Buenas pr√°cticas                                                                                                                                                                                                                                                        |
| ----------------------------- | --------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Login**                     | [Fuerza bruta](https://owasp.org/www-community/attacks/Brute_force_attack)                          | Script que prueba 1000 contrase√±as hasta adivinar una                                          | Implementar [Rate Limiting](https://developer.mozilla.org/en-US/docs/Glossary/Rate_limit), [CAPTCHA](https://en.wikipedia.org/wiki/CAPTCHA), bloqueo temporal tras varios intentos                                                                                               |
| **Login**                     | [SQL Injection](https://owasp.org/www-community/attacks/SQL_Injection)                              | Usuario ingresa `' OR '1'='1` y accede sin contrase√±a                                          | Usar [ORM](https://developer.mozilla.org/en-US/docs/Glossary/ORM) (django python, laravel php) o consultas preparadas                                                                                                                                                                                                 |
| **Login**                     | [Session Hijacking](https://owasp.org/www-community/attacks/Session_hijacking_attack)               | Atacante roba la [cookie](https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies) de sesi√≥n | Usar cookies [HttpOnly](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#httponly), [Secure](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#secure), [SameSite](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#samesite) |
| **Login / Tokens**            | [Robo de JWT](https://jwt.io/introduction)                                                          | Atacante roba un token almacenado en localStorage                                              | No guardar JWT en [localStorage](https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage), usar cookies seguras                                                                                                                                                             |
| **Login / Registro**          | Contrase√±as d√©biles o expuestas                                                                     | Hash roto o mal implementado                                                                   | Usar [bcrypt](https://en.wikipedia.org/wiki/Bcrypt) o [argon2](https://en.wikipedia.org/wiki/Argon2) con [salt](https://en.wikipedia.org/wiki/Salt_%28cryptography%29)                                                                                                                   |
| **Perfil de usuario**         | [IDOR (Broken Object Level Authorization)](https://owasp.org/Top10/A01_2021-Broken_Access_Control/) | Cambiar `id=123` por `id=124` en la URL y ver datos ajenos                                     | Validar permisos en backend, usar [UUIDs](https://en.wikipedia.org/wiki/Universally_unique_identifier)                                                                      |
| **Carrito / Checkout**        | [Parameter tampering](https://owasp.org/www-community/attacks/Web_Parameter_Tampering)                  | Cambiar el precio en la request JSON                                                           | Calcular precios en backend, no confiar en datos del cliente                                                                                                                                                                                                                             |
| **Pagos**                     | [Bypass de validaci√≥n](https://medium.com/@mdnafeed3/bypassing-input-validation-0-1000-799682d547ba)                   | Modificar el callback del pago a ‚Äúpagado‚Äù                                                      | Verificar pagos con la API oficial del proveedor                                                                                                                                                                                                                                         |
| **Pagos (webhook)**           | Webhook no autenticado                                                                              | Enviar falso ‚Äúpago exitoso‚Äù al backend                                                         | Validar con [HMAC](https://en.wikipedia.org/wiki/HMAC) o [token secreto](https://auth0.com/es/learn/token-based-authentication-made-easy)                                                                                                                                                                  |
| **Base de datos NoSQL**       | [NoSQL Injection](https://portswigger.net/web-security/nosql-injection)                          | `{ "$ne": null }` devuelve todos los usuarios                                                  | Validar tipos de datos y usar consultas parametrizadas                                                                                                                                                                                                                                   |
| **B√∫squeda / Comentarios**    | [XSS (Cross-Site Scripting)](https://owasp.org/www-community/attacks/xss/)                          | Usuario inyecta `<script>alert('XSS')</script>`                                                | Escapar salida, usar [CSP (Content Security Policy)](https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP)                                                                                                                                                                              |
| **Subida de archivos**        | [Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal)                            | Subir archivo con nombre `../../etc/passwd`                                                    | Renombrar archivo, validar ruta, guardar fuera del public                                                                                                                                                                                                                                |
| **Subida de archivos**        | MIME spoofing                                                                                       | Subir `.php` renombrado a `.jpg`                                                               | Validar [MIME type](https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types), usar almacenamiento externo ([S3](https://aws.amazon.com/s3/))                                                                                                                         |
| **API / Frontend**            | [CORS mal configurado](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS)                      | Dominio falso accede a tu API                                                                  | Restringir [Access-Control-Allow-Origin](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin)                                                                                                                                                          |
| **API p√∫blica**               | Abuso / scraping                                                                                    | Usuario hace 1000 requests por segundo                                                         | Implementar [API key management](https://docs.cloud.google.com/docs/authentication/api-keys?hl=es) y [Rate limiting](https://www.cloudflare.com/es-es/learning/bots/what-is-rate-limiting/)                                                                                                                                                                   |
| **Formularios**               | [CSRF (Cross-Site Request Forgery)](https://owasp.org/www-community/attacks/csrf)                   | Enlace malicioso ejecuta acci√≥n como otro usuario                                              | Usar tokens CSRF √∫nicos, validar origen                                                                                                                                                                                                                                                  |
| **Panel Admin**               | [Command Injection](https://owasp.org/www-community/attacks/Command_Injection)                      | Entrada del usuario ejecuta comando del sistema                                                | Escapar par√°metros, nunca ejecutar input sin validar                                                                                                                                                                                                                                     |
| **Panel Admin**               | Acceso sin roles o autenticaci√≥n d√©bil                                                              | Usuario normal accede a `/admin`                                                               | Implementar [MFA (multi-factor authentication)](https://en.wikipedia.org/wiki/Multi-factor_authentication) y [RBAC (role-based access control)](https://en.wikipedia.org/wiki/Role-based_access_control)                                                                                 |
| **Dependencias del proyecto** | Vulnerabilidades conocidas                                                                          | Uso de librer√≠a con CVE cr√≠tico                                                                | Analizar con [CVE scanner](https://nvd.nist.gov/vuln) o `npm audit` / `pip-audit`                                                                                                                                                                                                        |
| **General**                   | Falta de logs o auditor√≠a                                                                           | Ataques sin detecci√≥n                                                                          | Centralizar logs y alertas ([ELK](https://aws.amazon.com/es/what-is/elk-stack/#:~:text=La%20pila%20ELK%20es%20un,de%20seguridad%20y%20mucho%20m%C3%A1s.), [CloudWatch](https://aws.amazon.com/es/cloudwatch/), etc.)                                                                                                                                                                                                                                       |
| **General**                   | Exceso de privilegios                                                                               | Backend accede a todo con la misma cuenta DB                                                   | Aplicar principio de menor privilegio ([least privilege](https://en.wikipedia.org/wiki/Principle_of_least_privilege))                                                                                                                                                                                                                                 |
| **General**                   | Conexi√≥n insegura                                                                                   | Tr√°fico interceptado por [man-in-the-middle](https://en.wikipedia.org/wiki/Man-in-the-middle_attack#:~:text=In%20cryptography%20and%20computer%20security,actuality%20the%20attacker%20has%20inserted)                                                     | Forzar HTTPS y certificados v√°lidos                                                                                                                                                                                                                                                      |
